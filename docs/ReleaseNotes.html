<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
                      "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="stylesheet" href="llvm.css" type="text/css">
  <title>LLVM 2.3 Release Notes</title>
</head>
<body>

<div class="doc_title">LLVM 2.3 Release Notes</div>
 
<ol>
  <li><a href="#intro">Introduction</a></li>
  <li><a href="#whatsnew">What's New?</a></li>
  <li><a href="GettingStarted.html">Installation Instructions</a></li>
  <li><a href="#portability">Portability and Supported Platforms</a></li>
  <li><a href="#knownproblems">Known Problems</a>
  <li><a href="#additionalinfo">Additional Information</a></li>
</ol>

<div class="doc_author">
  <p>Written by the <a href="http://llvm.org">LLVM Team</a><p>
</div>

<!-- Done through Week-of-Mon-20080324.txt -->

<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="intro">Introduction</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>This document contains the release notes for the LLVM compiler
infrastructure, release 2.3.  Here we describe the status of LLVM, including
major improvements from the previous release and any known problems.  All LLVM
releases may be downloaded from the <a href="http://llvm.org/releases/">LLVM
releases web site</a>.</p>

<p>For more information about LLVM, including information about the latest
release, please check out the <a href="http://llvm.org/">main LLVM
web site</a>.  If you have questions or comments, the <a
href="http://mail.cs.uiuc.edu/mailman/listinfo/llvmdev">LLVM developer's mailing
list</a> is a good place to send them.</p>

<p>Note that if you are reading this file from a Subversion checkout or the 
main LLVM web page, this document applies to the <i>next</i> release, not the
current one.  To see the release notes for a specific releases, please see the
<a href="http://llvm.org/releases/">releases page</a>.</p>

</div>

<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="whatsnew">What's New?</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>This is the fourteenth public release of the LLVM Compiler Infrastructure. 
It includes a large number of features and refinements from LLVM 2.2.</p>

</div>

<!-- Unfinished features in 2.3:
  Machine LICM
  Machine Sinking
  LegalizeDAGTypes
 -->

<!--=========================================================================-->
<div class="doc_subsection">
<a name="changes">Major Changes in LLVM 2.3</a>
</div>

<div class="doc_text">

<p>LLVM 2.2 was the last LLVM release to support llvm-gcc 4.0 and llvm-upgrade.
llvm-gcc 4.0 has been replaced with llvm-gcc 4.2.  llvm-upgrade was useful for
upgrading LLVM 1.9 files to LLVM 2.x syntax, but you can always use a previous
LLVM release to do this.  One nice impact of this is that the LLVM regressionn
test suite no longer depends on llvm-upgrade, which makes it run faster.</p>

<p>LLVM 2.3 renames the LLVMBuilder and LLVMFoldingBuilder classes to
   IRBuilder.</p>

</div>

<!--=========================================================================-->
<div class="doc_subsection">
<a name="majorfeatures">Major New Features</a>
</div>

<div class="doc_text">

<p>LLVM 2.3 includes several major new capabilities:</p>

<ul>
<li>Multiple Return Value Support</li>


<li><p>LLVM 2.3 includes a complete reimplementation of the "llvmc" tool.  It is
designed to overcome several problems of the original llvmc and to provide a
superset of the features as the 'gcc' driver.</p>

<p>The main features of llvmc2 is:</p>

<ul>
<li>Extended handling of command line options and smart rules for
dispatching them to different tools.</li>
<li>Flexible (and extensible) rules for defining different tools.</li>
<li>The different intermediate steps performed by tools are represented
as edged in the abstract graph.</li>
</l>The 'language' for driver behaviour definition is tablegen and thus
it's relatively easy to add new features.</li>
<li>The definition of driver is transformed into set of C++ classes, thus
no runtime interpretation is needed.</li>
</ul>

</li>

<li>Reimplemented <a href="LinkTimeOptimization.html">LTO interface</a> in
 C.</li>


<li>kaleidoscope tutorial in ocaml.</li>

</ul>

</div>


<!--=========================================================================-->
<div class="doc_subsection">
<a name="frontends">llvm-gcc 4.2 Improvements and Clang</a>
</div>

<div class="doc_text">

<p>LLVM 2.3 fully supports llvm-gcc 4.2 front-end.</p>

<p>llvm-gcc 4.2 includes numerous fixes to better support the Objective-C
front-end.  Objective-C now works very well on Mac OS/X.</p>

<p>llvm-gcc 4.2 includes many other fixes which improve conformance with the
relevant parts of the GCC testsuite.</p>

<p>The <a href="http://clang.llvm.org/">clang project</a> is an effort to build
a set of new 'llvm native' front-end technologies for the LLVM optimizer
and code generator.  Currently, its C and Objective-C support is maturing 
nicely, and it has advanced source-to-source analysis and transformation
capabilities.  If you are interested in building source-level tools for C and
Objective-C (and eventually C++), you should take a look.  However, note that
clang is not an official part of the LLVM 2.3 release.  If you are interested in
this project, please see its <a href="http://clang.llvm.org/">web site</a>.</p>

</div>


<!--=========================================================================-->
<div class="doc_subsection">
<a name="coreimprovements">LLVM Core Improvements</a>
</div>

<div class="doc_text">
<p>New features include:
</p>


Common linkage?

Atomic operation support, Alpha, X86, X86-64, PowerPC. "__sync_synchronize"

<ul>
<li>The C and Ocaml bindings have received additional improvements. The
bindings now cover pass managers, several transformation passes, iteration
over the LLVM IR, target data, and parameter attribute lists.</li>
</ul>
  
</div>

<!--=========================================================================-->
<div class="doc_subsection">
<a name="codegen">Code Generator Improvements</a>
</div>

<div class="doc_text">

<p>We put a significant amount of work into the code generator infrastructure,
which allows us to implement more aggressive algorithms and make it run
faster:</p>

<ul>
<li>MemOperand in the code generator: describe me!.</li>
<li>Target-independent codegen infastructure now uses LLVM's APInt class for
    handling integer values, which allow it to support integer types larger
    than 64 bits. Note that support for such types is also dependent on
    target-specific support. Use of APInt is also a step toward support for
    non-power-of-2 integer sizes.</li>
<li>Several compile time speedups for code with large basic blocks.</li>
<li>Several improvements which make llc's <tt>--view-sunit-dags</tt>
    visualization of scheduling dependency graphs easier to understand.</li>
</ul>

</div>

<!--=========================================================================-->
<div class="doc_subsection">
<a name="optimizer">Optimizer Improvements</a>
</div>

<div class="doc_text">

<p>In addition to a huge array of bug fixes and minor performance tweaks, the 
LLVM 2.3 optimizers support a few major enhancements:</p>

<ul>

<li>Loop index set splitting on by default: describe me.</li>
<li>LLVM includes a new memcpy optimization pass which optimizes out dead
memcpy calls, unneeded copies of aggregates, and handles the return slot
optimization.  The LLVM optimizer now notices long sequences of consequtive
stores and merges them into memcpy's where profitable.</li>
<li>Alignment detection for vector memory references and for memcpy and
memset is now more aggressive.</li> 
</ul>

</div>


<!--=========================================================================-->
<div class="doc_subsection">
<a name="x86specific">X86/X86-64 Specific Improvements</a>
</div>

<div class="doc_text">
<p>New target-specific features include:
</p>

<ul>
<li>llvm-gcc's X86-64 ABI conformance is far improved, particularly in the
    area of passing and returning structures by value.  llvm-gcc Compiled code
    now interoperates very well on X86-64 systems with other compilers.</li>

<li>The LLVM X86 backend now supports the support SSE 4.1 instruction set, and
    the llvm-gcc 4.2 front-end supports the SSE 4.1 compiler builtins.</li>
       
<li>The X86 backend now does a number of optimizations that aim to avoid
    converting numbers back and forth from SSE registers to the X87 floating
    point stack.</li>
    
<li>The X86 backend supports stack realignment, which is particularly useful for
    vector code on OS's without 16-byte aligned stacks.</li>

<li>The X86 backend now supports the "sseregparm" options in GCC, which allow
    functions to be tagged as passing floating point values in SSE
    registers.</li>

<li>Trampolines (taking the address of a nested function) now work on
    Linux/x86-64.</li>
    
<li><tt>__builtin_prefetch</tt> is now compiled into the appropriate prefetch
    instructions instead of being ignored.</li>

<li>128-bit integers are now supported on x86-64 targets.</li>

</ul>
  
</div>

<!--=========================================================================-->
<div class="doc_subsection">
<a name="targetspecific">Other Target Specific Improvements</a>
</div>

<div class="doc_text">
<p>New target-specific features include:
</p>

<ul>
<li>The LLVM C backend now supports vectors code.</li>
    

</ul>
  
</div>



<!--=========================================================================-->
<div class="doc_subsection">
<a name="otherimprovements">Other Improvements</a>
</div>

<div class="doc_text">
<p>New features include:
</p>

<ul>
<li>LLVM now builds with GCC 4.3.</li>
<li>llvm2cpp tool was moved into llc, use llc -march=cpp</li>
</ul>
  
</div>

<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="portability">Portability and Supported Platforms</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>LLVM is known to work on the following platforms:</p>

<ul>
<li>Intel and AMD machines running Red Hat Linux, Fedora Core and FreeBSD 
      (and probably other unix-like systems).</li>
<li>PowerPC and X86-based Mac OS X systems, running 10.3 and above in 32-bit and
    64-bit modes.</li>
<li>Intel and AMD machines running on Win32 using MinGW libraries (native).</li>
<li>Intel and AMD machines running on Win32 with the Cygwin libraries (limited
    support is available for native builds with Visual C++).</li>
<li>Sun UltraSPARC workstations running Solaris 8.</li>
<li>Alpha-based machines running Debian GNU/Linux.</li>
<li>Itanium-based machines running Linux and HP-UX.</li>
</ul>

<p>The core LLVM infrastructure uses GNU autoconf to adapt itself
to the machine and operating system on which it is built.  However, minor
porting may be required to get LLVM to work on new platforms.  We welcome your
portability patches and reports of successful builds or error messages.</p>

</div>

<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="knownproblems">Known Problems</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>This section contains all known problems with the LLVM system, listed by
component.  As new problems are discovered, they will be added to these
sections.  If you run into a problem, please check the <a
href="http://llvm.org/bugs/">LLVM bug database</a> and submit a bug if
there isn't already one.</p>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="experimental">Experimental features included with this release</a>
</div>

<div class="doc_text">

<p>The following components of this LLVM release are either untested, known to
be broken or unreliable, or are in early development.  These components should
not be relied on, and bugs should not be filed against them, but they may be
useful to some people.  In particular, if you would like to work on one of these
components, please contact us on the <a
href="http://lists.cs.uiuc.edu/mailman/listinfo/llvmdev">LLVMdev list</a>.</p>

<ul>
<li>The MSIL, IA64, Alpha, SPU, and MIPS backends are experimental.</li>
<li>The LLC "<tt>-filetype=asm</tt>" (the default) is the only supported
    value for this option.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="x86-be">Known problems with the X86 back-end</a>
</div>

<div class="doc_text">

<ul>
<li>The X86 backend does not yet support all <a 
    href="http://llvm.org/PR879">inline assembly that uses the X86 floating
    point stack</a>.  It supports the 'f' and 't' constraints, but not 'u'.</li>
<li>The X86 backend generates inefficient floating point code when configured to
    generate code for systems that don't have SSE2.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="ppc-be">Known problems with the PowerPC back-end</a>
</div>

<div class="doc_text">

<ul>
<li>The Linux PPC32/ABI support needs testing for the interpreter and static
compilation, and lacks support for debug information.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="arm-be">Known problems with the ARM back-end</a>
</div>

<div class="doc_text">

<ul>
<li>Thumb mode works only on ARMv6 or higher processors. On sub-ARMv6
processors, thumb programs can crash or produce wrong
results (<a href="http://llvm.org/PR1388">PR1388</a>).</li>
<li>Compilation for ARM Linux OABI (old ABI) is supported, but not fully tested.
</li>
<li>There is a bug in QEMU-ARM (&lt;= 0.9.0) which causes it to incorrectly execute
programs compiled with LLVM.  Please use more recent versions of QEMU.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="sparc-be">Known problems with the SPARC back-end</a>
</div>

<div class="doc_text">

<ul>
<li>The SPARC backend only supports the 32-bit SPARC ABI (-m32), it does not
    support the 64-bit SPARC ABI (-m64).</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="alpha-be">Known problems with the Alpha back-end</a>
</div>

<div class="doc_text">

<ul>

<li>On 21164s, some rare FP arithmetic sequences which may trap do not have the
appropriate nops inserted to ensure restartability.</li>

</ul>
</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="ia64-be">Known problems with the IA64 back-end</a>
</div>

<div class="doc_text">

<ul>

<li>C++ programs are likely to fail on IA64, as calls to <tt>setjmp</tt> are
made where the argument is not 16-byte aligned, as required on IA64. (Strictly
speaking this is not a bug in the IA64 back-end; it will also be encountered
when building C++ programs using the C back-end.)</li>

<li>The C++ front-end does not use <a href="http://llvm.org/PR406">IA64
ABI compliant layout of v-tables</a>.  In particular, it just stores function
pointers instead of function descriptors in the vtable.  This bug prevents
mixing C++ code compiled with LLVM with C++ objects compiled by other C++
compilers.</li>

<li>There are a few ABI violations which will lead to problems when mixing LLVM
output with code built with other compilers, particularly for floating-point
programs.</li>

<li>Defining vararg functions is not supported (but calling them is ok).</li>

<li>The Itanium backend has bitrotted somewhat.</li>
</ul>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="c-be">Known problems with the C back-end</a>
</div>

<div class="doc_text">

<ul>
<li><a href="http://llvm.org/PR802">The C backend has only basic support for
    inline assembly code</a>.</li>
<li><a href="http://llvm.org/PR1658">The C backend violates the ABI of common
    C++ programs</a>, preventing intermixing between C++ compiled by the CBE and
    C++ code compiled with LLC or native compilers.</li>
<li>The C backend does not support all exception handling constructs.</li>
</ul>

</div>


<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="c-fe">Known problems with the llvm-gcc C front-end</a>
</div>

<!-- _______________________________________________________________________ -->
<div class="doc_subsubsection">Bugs</div>

<div class="doc_text">

<p>llvm-gcc does not currently support <a href="http://llvm.org/PR869">Link-Time
Optimization</a> on most platforms "out-of-the-box".  Please inquire on the
llvmdev mailing list if you are interested.</p>

<p>The only major language feature of GCC not supported by llvm-gcc is
    the <tt>__builtin_apply</tt> family of builtins.   However, some extensions
    are only supported on some targets.  For example, trampolines are only
    supported on some targets, which are used when you take the address of a
    nested function.</p>

<p>If you run into GCC extensions which are not supported, please let us know.
</p>

</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="c++-fe">Known problems with the llvm-gcc C++ front-end</a>
</div>

<div class="doc_text">

<p>The C++ front-end is considered to be fully
tested and works for a number of non-trivial programs, including LLVM
itself, Qt, Mozilla, etc.</p>

<ul>
<li>Exception handling works well on the X86 and PowerPC targets, including
x86-64 darwin.  This works when linking to a libstdc++ compiled by GCC.  It is
supported on x86-64 linux, but that is disabled by default in this release.</li>
</ul>

</div>


<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="ada-fe">Known problems with the llvm-gcc Ada front-end</a>
</div>

<div class="doc_text">
The llvm-gcc 4.2 Ada compiler works fairly well, however this is not a mature
technology and problems should be expected.
<ul>
<li>The Ada front-end currently only builds on x86-32.  This is mainly due
to lack of trampoline support (pointers to nested functions) on other platforms,
however it <a href="http://llvm.org/PR2006">also fails to build on x86-64</a>
which does support trampolines.</li>
<li>The Ada front-end <a href="http://llvm.org/PR2007">fails to bootstrap</a>.
Workaround: configure with --disable-bootstrap.</li>
<li>The c380004 and <a href="http://llvm.org/PR2010">c393010</a> ACATS tests
fail (c380004 also fails with gcc-4.2 mainline).</li>
<li>Many gcc specific Ada tests continue to crash the compiler.</li>
<li>The -E binder option (exception backtraces)
<a href="http://llvm.org/PR1982">does not work</a> and will result in programs
crashing if an exception is raised.  Workaround: do not use -E.</li>
<li>Only discrete types <a href="http://llvm.org/PR1981">are allowed to start
or finish at a non-byte offset</a> in a record.  Workaround: do not pack records
or use representation clauses that result in a field of a non-discrete type
starting or finishing in the middle of a byte.</li>
<li>The lli interpreter <a href="http://llvm.org/PR2009">considers 'main'
as generated by the Ada binder to be invalid</a>.
Workaround: hand edit the file to use pointers for argv and envp rather than
integers.</li>
<li>The -fstack-check option <a href="http://llvm.org/PR2008">is ignored</a>.</li>
</ul>
</div>

<!-- ======================================================================= -->
<div class="doc_subsection">
  <a name="fortran-fe">Known problems with the llvm-gcc Fortran front-end</a>
</div>

<div class="doc_text">

<ul>
<li>The llvm-gcc 4.2 gfortran front-end supports a broad range of Fortran code, but does
<a href="http://llvm.org/PR1971">not support EQUIVALENCE yet</a>.</li>
</ul>
</div>



<!-- *********************************************************************** -->
<div class="doc_section">
  <a name="additionalinfo">Additional Information</a>
</div>
<!-- *********************************************************************** -->

<div class="doc_text">

<p>A wide variety of additional information is available on the <a
href="http://llvm.org">LLVM web page</a>, in particular in the <a
href="http://llvm.org/docs/">documentation</a> section.  The web page also
contains versions of the API documentation which is up-to-date with the
Subversion version of the source code.
You can access versions of these documents specific to this release by going
into the "<tt>llvm/doc/</tt>" directory in the LLVM tree.</p>

<p>If you have any questions or comments about LLVM, please feel free to contact
us via the <a href="http://llvm.org/docs/#maillist"> mailing
lists</a>.</p>

</div>

<!-- *********************************************************************** -->

<hr>
<address>
  <a href="http://jigsaw.w3.org/css-validator/check/referer"><img
  src="http://jigsaw.w3.org/css-validator/images/vcss" alt="Valid CSS!"></a>
  <a href="http://validator.w3.org/check/referer"><img
  src="http://www.w3.org/Icons/valid-html401" alt="Valid HTML 4.01!"></a>

  <a href="http://llvm.org/">LLVM Compiler Infrastructure</a><br>
  Last modified: $Date$
</address>

</body>
</html>
